<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Detail Produk - Simple E-Commerce</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <link rel="stylesheet" href="assets/css/style.css" />
  </head>

  <body>
    <!-- HEADER -->
    <header class="bg-white shadow-sm p-3 mb-4">
      <div class="container d-flex justify-content-between align-items-center">
        <h3 class="m-0">
          <i class="bi bi-shop text-primary me-2"></i>Simple E-Commerce
        </h3>

        <nav class="d-flex gap-3">
          <a href="index.html" class="text-dark">Beranda</a>
          <a href="cart.html" class="text-dark">Keranjang</a>
        </nav>
      </div>
    </header>

    <div class="container">
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="index.html" class="text-decoration-none">Beranda</a>
          </li>
          <li class="breadcrumb-item">
            <a href="index.html" class="text-decoration-none">Produk</a>
          </li>
          <li id="breadcrumb-name" class="breadcrumb-item active"></li>
        </ol>
      </nav>

      <!-- ERROR MESSAGE -->
      <div
        id="product-not-found"
        class="alert alert-danger d-flex align-items-center"
        style="display: none"
      >
        <i class="bi bi-exclamation-triangle me-2 fs-4"></i>
        <div><strong>Error 404!</strong> Produk tidak ditemukan.</div>
      </div>

      <!-- PRODUCT DETAIL -->
      <div
        id="product-content"
        class="card shadow-sm mb-4"
        style="display: none"
      >
        <div class="card-body p-4">
          <div class="row g-4">
            <!-- IMAGE -->
            <div class="col-md-5">
              <div class="position-relative">
                <img
                  id="product-image"
                  src=""
                  class="img-fluid rounded shadow-sm w-100"
                  style="height: 400px; object-fit: cover"
                />
                <span
                  id="stock-badge"
                  class="badge position-absolute top-0 start-0 m-3"
                ></span>
              </div>
            </div>

            <!-- INFO -->
            <div class="col-md-7">
              <div class="d-flex flex-column h-100">
                <div class="mb-3">
                  <h2 id="product-name" class="fw-bold mb-2"></h2>
                  <span
                    id="product-category"
                    class="badge bg-light text-dark border"
                  ></span>
                </div>

                <div class="mb-4">
                  <h3 id="product-price" class="text-primary fw-bold mb-0"></h3>
                  <small class="text-muted">Harga satuan</small>
                </div>

                <div class="mb-4">
                  <h5 class="fw-bold mb-2">
                    <i class="bi bi-info-circle me-2"></i>Deskripsi Produk
                  </h5>
                  <p
                    id="product-description"
                    class="text-muted"
                    style="line-height: 1.8"
                  ></p>
                </div>

                <div class="mb-4">
                  <h6 class="fw-bold mb-2">
                    <i class="bi bi-box-seam me-2"></i>Ketersediaan Stok
                  </h6>
                  <div class="d-flex align-items-center gap-2">
                    <span id="stock-info" class="badge fs-6 px-3 py-2"></span>
                  </div>
                </div>

                <div class="mt-auto">
                  <div class="d-flex gap-2">
                    <button
                      id="addBtn"
                      class="btn btn-primary btn-lg flex-fill"
                    >
                      <i class="bi bi-cart-plus me-2"></i> Tambah ke Keranjang
                    </button>

                    <a
                      href="index.html"
                      class="btn btn-outline-secondary btn-lg"
                    >
                      <i class="bi bi-arrow-left"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- FOOTER -->
    <footer class="text-center p-3 mt-4 bg-light">
      Â© 2025 Simple E-Commerce
    </footer>

    <script src="assets/js/add_to_cart.js"></script>

    <script>
      // === Ambil ID dari URL ===
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");

      // === Ambil data produk dari localStorage ===
      const products = JSON.parse(localStorage.getItem("products")) || [];

      // Temukan produk berdasarkan id
      const product = products.find((p) => p.id == id);

      // Elemen HTML
      const notFound = document.getElementById("product-not-found");
      const content = document.getElementById("product-content");
      const breadcrumb = document.getElementById("breadcrumb-name");

      if (!product) {
        notFound.style.display = "flex";
      } else {
        content.style.display = "block";

        // Set breadcrumb
        breadcrumb.textContent = product.name;

        // Isi data ke HTML
        document.getElementById("product-name").textContent = product.name;
        document.getElementById("product-category").textContent =
          product.category || "Tanpa kategori";
        document.getElementById("product-price").textContent =
          "Rp " + product.price.toLocaleString("id-ID");
        document.getElementById("product-description").textContent =
          product.description || "-";
        document.getElementById("product-image").src = product.image;

        // ===== STOCK =====
        const stock = product.stock;
        const stockBadge = document.getElementById("stock-badge");
        const stockInfo = document.getElementById("stock-info");

        if (stock > 0) {
          stockBadge.className =
            "badge bg-success position-absolute top-0 start-0 m-3";
          stockBadge.innerHTML = `<i class="bi bi-check-circle me-1"></i> Tersedia`;

          stockInfo.className =
            "badge bg-success-subtle text-success fs-6 px-3 py-2";
          stockInfo.innerHTML = `<i class="bi bi-check-circle-fill me-1"></i> Stok: ${stock} unit`;
        } else {
          stockBadge.className =
            "badge bg-danger position-absolute top-0 start-0 m-3";
          stockBadge.innerHTML = `<i class="bi bi-x-circle me-1"></i> Habis`;

          stockInfo.className =
            "badge bg-danger-subtle text-danger fs-6 px-3 py-2";
          stockInfo.textContent = "Stok Habis";

          // Disable button
          document.getElementById("addBtn").disabled = true;
          document.getElementById("addBtn").classList.add("btn-secondary");
        }

        // === Add to cart button ===
        document.getElementById("addBtn").addEventListener("click", () => {
          addToCart(product.id, product.name, product.price);
        });
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
